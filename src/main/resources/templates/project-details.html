<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head><title>Project details</title></head>
<body>
<p><a th:href="@{/projects}">‚Üê Back to list</a></p>

<h2>Project details</h2>
<ul>
  <li><b>ID:</b> <span th:text="${project.id}"></span></li>
  <li><b>Name:</b> <span th:text="${project.projectName}"></span></li>
  <li><b>Version:</b> <span th:text="${project.version}"></span></li>
</ul>

<h3>Installer settings</h3>

<div th:if="${project.installerSettings == null}">
  <i>Not set yet</i>
  <form th:action="@{|/projects/${project.id}/setInstallerSettings|}" method="post">
    <label for="installPath">Install Path:</label>
    <input type="text" id="installPath" name="installPath" placeholder="Enter Install Path" required />
    <br />

    <label for="createDesktopShortcut">Create Desktop Shortcut:</label>
    <input type="checkbox" id="createDesktopShortcut" name="createDesktopShortcut" />
    <br />

    <label for="language">Language:</label>
    <select id="language" name="language">
      <option value="English">English</option>
      <option value="Spanish">Spanish</option>
      <option value="French">French</option>
    </select>
    <br />

    <label for="mainClass">Main Class:</label>
    <input type="text" id="mainClass" name="mainClass" placeholder="Enter Main Class" required />
    <br />

    <label for="requirements">System Requirements:</label>
    <input type="text" id="requirements" name="requirements" placeholder="e.g., os windows AND java 17" />
    <br />

    <button type="submit">Save Settings</button>
  </form>
</div>

<div th:if="${project.installerSettings != null}">
  <ul>
    <li th:text="'Path: ' + ${project.installerSettings.installPath}"></li>
    <li th:text="'Desktop shortcut: ' + ${project.installerSettings.createDesktopShortcut}"></li>
    <li th:text="'Language: ' + ${project.installerSettings.language}"></li>
    <li th:text="'Main Class: ' + ${project.installerSettings.mainClass}"></li>
    <li th:text="'Requirements: ' + (${project.installerSettings.requirements} ?: 'None')"></li>
  </ul>

  <details>
    <summary style="cursor: pointer; color: blue;">Edit Settings</summary>
    <form th:action="@{|/projects/${project.id}/setInstallerSettings|}" method="post" style="margin-top: 10px; border: 1px solid #ccc; padding: 10px;">
      <label for="installPathEdit">Install Path:</label>
      <input type="text" id="installPathEdit" name="installPath" th:value="${project.installerSettings.installPath}" required />
      <br />

      <label for="createDesktopShortcutEdit">Create Desktop Shortcut:</label>
      <input type="checkbox" id="createDesktopShortcutEdit" name="createDesktopShortcut" th:checked="${project.installerSettings.createDesktopShortcut}" />
      <br />

      <label for="languageEdit">Language:</label>
      <select id="languageEdit" name="language">
        <option value="English" th:selected="${project.installerSettings.language == 'English'}">English</option>
        <option value="Spanish" th:selected="${project.installerSettings.language == 'Spanish'}">Spanish</option>
        <option value="French" th:selected="${project.installerSettings.language == 'French'}">French</option>
      </select>
      <br />

      <label for="mainClassEdit">Main Class:</label>
      <input type="text" id="mainClassEdit" name="mainClass" th:value="${project.installerSettings.mainClass}" required />
      <br />

      <label for="requirementsEdit">System Requirements:</label>
      <input type="text" id="requirementsEdit" name="requirements" th:value="${project.installerSettings.requirements}" placeholder="os windows AND java 17" />
      <br />

      <button type="submit">Update Settings</button>
    </form>
  </details>
</div>

<h3>Files</h3>
<div th:if="${#lists.isEmpty(project.files)}">
  <i>No files yet</i>
</div>
<ul th:if="${!#lists.isEmpty(project.files)}">
  <li th:each="f : ${project.files}"
      th:text="${f.fileName} + ' (' + ${f.fileType} + ') - ' + ${f.path}"></li>
</ul>

<h3>Files for Installation</h3>
<form th:action="@{|/projects/${project.id}/addFiles|}" method="post" enctype="multipart/form-data">
  <label for="files">Select Files:</label>
  <input type="file" id="files" name="files" multiple />
  <button type="submit">Add Files</button>
</form>

<h3>Generate Installer</h3>
<form th:action="@{|/projects/${project.id}/generateInstaller|}" method="post">
  <button type="submit">Generate .exe Installer</button>
</form>

<div th:if="${message}">
  <p style="color: green;" th:text="${message}"></p>
</div>

</body>
</html>